[14:31:26] Loading modules
[14:31:26] Activating conda env
[14:31:28] Starting training script
Starting program with arguments: Namespace(model='cnn', mode='train', train_mode='fine_tune', data_dir='food_101', epochs=50, batch_size=200, num_classes=102, img_size=256, percentage=13130.0, input_model='cnn_model.pth', input_model_G=None, input_model_D=None, seed=89)
Loading data from food_101...
num_to_keep: 130
Reduced training set size: 13130
Data loaded successfully.
Loaded CNN model from cnn_model.pth
Training in fine_tune mode, with 13130 datapoints
[2025-04-23 14:31:34] Epoch 1/50
train Loss: 1.3673 Sample-Acc: 0.5608
val Loss: 1.3449 Sample-Acc: 0.6108
[2025-04-23 14:35:01] Finished epoch 1
----------
[2025-04-23 14:35:01] Epoch 2/50
train Loss: 1.3354 Sample-Acc: 0.6195
val Loss: 1.2810 Sample-Acc: 0.6483
[2025-04-23 14:38:14] Finished epoch 2
----------
[2025-04-23 14:38:14] Epoch 3/50
train Loss: 1.3000 Sample-Acc: 0.6173
val Loss: 1.2402 Sample-Acc: 0.6227
[2025-04-23 14:41:28] Finished epoch 3
----------
[2025-04-23 14:41:28] Epoch 4/50
train Loss: 1.2797 Sample-Acc: 0.6181
val Loss: 1.2142 Sample-Acc: 0.6324
[2025-04-23 14:44:42] Finished epoch 4
----------
[2025-04-23 14:44:42] Epoch 5/50
train Loss: 1.2670 Sample-Acc: 0.6175
val Loss: 1.1957 Sample-Acc: 0.6294
[2025-04-23 14:47:56] Finished epoch 5
----------
[2025-04-23 14:47:56] Epoch 6/50
train Loss: 1.2568 Sample-Acc: 0.6236
val Loss: 1.1819 Sample-Acc: 0.6477
[2025-04-23 14:51:11] Finished epoch 6
----------
[2025-04-23 14:51:11] Epoch 7/50
train Loss: 1.2525 Sample-Acc: 0.6303
val Loss: 1.1752 Sample-Acc: 0.6445
[2025-04-23 14:54:25] Finished epoch 7
----------
[2025-04-23 14:54:25] Epoch 8/50
train Loss: 1.2420 Sample-Acc: 0.6358
val Loss: 1.1646 Sample-Acc: 0.6448
[2025-04-23 14:57:38] Finished epoch 8
----------
[2025-04-23 14:57:38] Epoch 9/50
train Loss: 1.2358 Sample-Acc: 0.6379
val Loss: 1.1580 Sample-Acc: 0.6501
[2025-04-23 15:00:53] Finished epoch 9
----------
[2025-04-23 15:00:53] Epoch 10/50
train Loss: 1.2335 Sample-Acc: 0.6387
val Loss: 1.1491 Sample-Acc: 0.6526
[2025-04-23 15:04:07] Finished epoch 10
----------
[2025-04-23 15:04:07] Epoch 11/50
train Loss: 1.2282 Sample-Acc: 0.6411
val Loss: 1.1443 Sample-Acc: 0.6545
[2025-04-23 15:07:21] Finished epoch 11
----------
[2025-04-23 15:07:21] Epoch 12/50
train Loss: 1.2243 Sample-Acc: 0.6425
val Loss: 1.1423 Sample-Acc: 0.6579
[2025-04-23 15:10:35] Finished epoch 12
----------
[2025-04-23 15:10:35] Epoch 13/50
train Loss: 1.2248 Sample-Acc: 0.6448
val Loss: 1.1353 Sample-Acc: 0.6624
[2025-04-23 15:13:47] Finished epoch 13
----------
[2025-04-23 15:13:47] Epoch 14/50
train Loss: 1.2187 Sample-Acc: 0.6489
val Loss: 1.1296 Sample-Acc: 0.6609
[2025-04-23 15:17:02] Finished epoch 14
----------
[2025-04-23 15:17:02] Epoch 15/50
train Loss: 1.2168 Sample-Acc: 0.6503
val Loss: 1.1262 Sample-Acc: 0.6634
[2025-04-23 15:20:16] Finished epoch 15
----------
[2025-04-23 15:20:16] Epoch 16/50
train Loss: 1.2183 Sample-Acc: 0.6494
val Loss: 1.1223 Sample-Acc: 0.6691
[2025-04-23 15:23:29] Finished epoch 16
----------
[2025-04-23 15:23:29] Epoch 17/50
train Loss: 1.2161 Sample-Acc: 0.6516
val Loss: 1.1228 Sample-Acc: 0.6635
[2025-04-23 15:26:44] Finished epoch 17
----------
[2025-04-23 15:26:44] Epoch 18/50
train Loss: 1.2100 Sample-Acc: 0.6533
val Loss: 1.1183 Sample-Acc: 0.6649
[2025-04-23 15:29:58] Finished epoch 18
----------
[2025-04-23 15:29:58] Epoch 19/50
train Loss: 1.2107 Sample-Acc: 0.6547
val Loss: 1.1178 Sample-Acc: 0.6607
[2025-04-23 15:33:12] Finished epoch 19
----------
[2025-04-23 15:33:12] Epoch 20/50
train Loss: 1.2057 Sample-Acc: 0.6547
val Loss: 1.1163 Sample-Acc: 0.6649
[2025-04-23 15:36:25] Finished epoch 20
----------
[2025-04-23 15:36:25] Epoch 21/50
train Loss: 1.2056 Sample-Acc: 0.6546
val Loss: 1.1121 Sample-Acc: 0.6674
[2025-04-23 15:39:39] Finished epoch 21
----------
[2025-04-23 15:39:39] Epoch 22/50
train Loss: 1.2027 Sample-Acc: 0.6593
val Loss: 1.1087 Sample-Acc: 0.6677
[2025-04-23 15:42:53] Finished epoch 22
----------
[2025-04-23 15:42:53] Epoch 23/50
train Loss: 1.2059 Sample-Acc: 0.6557
val Loss: 1.1065 Sample-Acc: 0.6699
[2025-04-23 15:46:07] Finished epoch 23
----------
[2025-04-23 15:46:07] Epoch 24/50
train Loss: 1.2012 Sample-Acc: 0.6567
val Loss: 1.1034 Sample-Acc: 0.6838
[2025-04-23 15:49:19] Finished epoch 24
----------
[2025-04-23 15:49:19] Epoch 25/50
train Loss: 1.2038 Sample-Acc: 0.6583
val Loss: 1.1030 Sample-Acc: 0.6718
[2025-04-23 15:52:30] Finished epoch 25
----------
[2025-04-23 15:52:30] Epoch 26/50
train Loss: 1.2009 Sample-Acc: 0.6590
val Loss: 1.1018 Sample-Acc: 0.6680
[2025-04-23 15:55:44] Finished epoch 26
----------
[2025-04-23 15:55:44] Epoch 27/50
train Loss: 1.2017 Sample-Acc: 0.6578
val Loss: 1.0998 Sample-Acc: 0.6798
[2025-04-23 15:58:58] Finished epoch 27
----------
[2025-04-23 15:58:58] Epoch 28/50
train Loss: 1.2025 Sample-Acc: 0.6585
val Loss: 1.0997 Sample-Acc: 0.6729
[2025-04-23 16:02:13] Finished epoch 28
----------
[2025-04-23 16:02:13] Epoch 29/50
train Loss: 1.2000 Sample-Acc: 0.6582
val Loss: 1.0969 Sample-Acc: 0.6714
[2025-04-23 16:05:27] Finished epoch 29
----------
[2025-04-23 16:05:27] Epoch 30/50
train Loss: 1.2013 Sample-Acc: 0.6568
val Loss: 1.0997 Sample-Acc: 0.6777
[2025-04-23 16:08:40] Finished epoch 30
----------
[2025-04-23 16:08:40] Epoch 31/50
train Loss: 1.1977 Sample-Acc: 0.6588
val Loss: 1.0960 Sample-Acc: 0.6687
[2025-04-23 16:11:54] Finished epoch 31
----------
[2025-04-23 16:11:54] Epoch 32/50
train Loss: 1.1973 Sample-Acc: 0.6569
val Loss: 1.0895 Sample-Acc: 0.6815
[2025-04-23 16:15:08] Finished epoch 32
----------
[2025-04-23 16:15:08] Epoch 33/50
train Loss: 1.1928 Sample-Acc: 0.6615
val Loss: 1.0917 Sample-Acc: 0.6851
[2025-04-23 16:18:22] Finished epoch 33
----------
[2025-04-23 16:18:22] Epoch 34/50
train Loss: 1.2002 Sample-Acc: 0.6565
val Loss: 1.0961 Sample-Acc: 0.6712
[2025-04-23 16:21:37] Finished epoch 34
----------
[2025-04-23 16:21:37] Epoch 35/50
train Loss: 1.1991 Sample-Acc: 0.6573
val Loss: 1.0935 Sample-Acc: 0.6767
[2025-04-23 16:24:51] Finished epoch 35
----------
[2025-04-23 16:24:51] Epoch 36/50
train Loss: 1.1980 Sample-Acc: 0.6580
val Loss: 1.0904 Sample-Acc: 0.6788
[2025-04-23 16:28:05] Finished epoch 36
----------
[2025-04-23 16:28:05] Epoch 37/50
train Loss: 1.1917 Sample-Acc: 0.6635
val Loss: 1.0944 Sample-Acc: 0.6743
[2025-04-23 16:31:18] Finished epoch 37
----------
[2025-04-23 16:31:18] Epoch 38/50
train Loss: 1.1932 Sample-Acc: 0.6581
val Loss: 1.0873 Sample-Acc: 0.6789
[2025-04-23 16:34:28] Finished epoch 38
----------
[2025-04-23 16:34:28] Epoch 39/50
train Loss: 1.1980 Sample-Acc: 0.6573
val Loss: 1.0883 Sample-Acc: 0.6727
[2025-04-23 16:37:38] Finished epoch 39
----------
[2025-04-23 16:37:38] Epoch 40/50
train Loss: 1.1920 Sample-Acc: 0.6597
val Loss: 1.0917 Sample-Acc: 0.6760
[2025-04-23 16:40:48] Finished epoch 40
----------
[2025-04-23 16:40:48] Epoch 41/50
train Loss: 1.1955 Sample-Acc: 0.6581
val Loss: 1.0900 Sample-Acc: 0.6760
[2025-04-23 16:43:56] Finished epoch 41
----------
[2025-04-23 16:43:56] Epoch 42/50
train Loss: 1.1923 Sample-Acc: 0.6615
val Loss: 1.0869 Sample-Acc: 0.6782
[2025-04-23 16:47:07] Finished epoch 42
----------
[2025-04-23 16:47:07] Epoch 43/50
train Loss: 1.1921 Sample-Acc: 0.6616
val Loss: 1.0878 Sample-Acc: 0.6771
[2025-04-23 16:50:18] Finished epoch 43
----------
[2025-04-23 16:50:18] Epoch 44/50
train Loss: 1.1951 Sample-Acc: 0.6576
val Loss: 1.0890 Sample-Acc: 0.6769
[2025-04-23 16:53:29] Finished epoch 44
----------
[2025-04-23 16:53:29] Epoch 45/50
train Loss: 1.1909 Sample-Acc: 0.6610
val Loss: 1.0908 Sample-Acc: 0.6749
[2025-04-23 16:56:41] Finished epoch 45
----------
[2025-04-23 16:56:41] Epoch 46/50
train Loss: 1.1939 Sample-Acc: 0.6607
val Loss: 1.0842 Sample-Acc: 0.6766
[2025-04-23 16:59:53] Finished epoch 46
----------
[2025-04-23 16:59:53] Epoch 47/50
train Loss: 1.1889 Sample-Acc: 0.6598
val Loss: 1.0843 Sample-Acc: 0.6822
[2025-04-23 17:03:04] Finished epoch 47
----------
[2025-04-23 17:03:04] Epoch 48/50
train Loss: 1.1903 Sample-Acc: 0.6610
val Loss: 1.0843 Sample-Acc: 0.6839
[2025-04-23 17:06:16] Finished epoch 48
----------
[2025-04-23 17:06:16] Epoch 49/50
train Loss: 1.1873 Sample-Acc: 0.6632
val Loss: 1.0922 Sample-Acc: 0.6725
[2025-04-23 17:09:27] Finished epoch 49
----------
[2025-04-23 17:09:27] Epoch 50/50
train Loss: 1.1889 Sample-Acc: 0.6625
val Loss: 1.0763 Sample-Acc: 0.6818
[2025-04-23 17:12:38] Finished epoch 50
----------
Training complete. Best val loss: 1.0763
Test Sample-Acc: 0.6819
Traceback (most recent call last):
  File "/gpfs/u/scratch/TRSL/shared/code2/main.py", line 89, in <module>
    main()
  File "/gpfs/u/scratch/TRSL/shared/code2/main.py", line 67, in main
    trainer.save('gan_generator.pth', 'gan_discriminator.pth')
TypeError: CNNTrainer.save() takes 2 positional arguments but 3 were given
srun: error: npl05: task 0: Exited with exit code 1
[17:14:20] SLURM job complete
