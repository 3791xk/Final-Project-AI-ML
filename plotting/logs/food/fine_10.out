[14:07:32] Loading modules
[14:07:32] Activating conda env
[14:07:33] Starting training script
Starting program with arguments: Namespace(model='cnn', mode='train', train_mode='fine_tune', data_dir='food_101', epochs=50, batch_size=200, num_classes=102, img_size=256, percentage=1515.0, input_model='cnn_model.pth', input_model_G=None, input_model_D=None, seed=89)
Loading data from food_101...
num_to_keep: 15
Reduced training set size: 1515
Data loaded successfully.
Loaded CNN model from cnn_model.pth
Training in fine_tune mode, with 1515 datapoints
[2025-04-23 14:07:39] Epoch 1/50
train Loss: 1.4241 Sample-Acc: 0.5805
val Loss: 1.4184 Sample-Acc: 0.5415
[2025-04-23 14:09:34] Finished epoch 1
----------
[2025-04-23 14:09:34] Epoch 2/50
train Loss: 1.4074 Sample-Acc: 0.6984
val Loss: 1.4156 Sample-Acc: 0.6013
[2025-04-23 14:11:01] Finished epoch 2
----------
[2025-04-23 14:11:01] Epoch 3/50
train Loss: 1.4031 Sample-Acc: 0.7159
val Loss: 1.4142 Sample-Acc: 0.6080
[2025-04-23 14:12:26] Finished epoch 3
----------
[2025-04-23 14:12:26] Epoch 4/50
train Loss: 1.4049 Sample-Acc: 0.7208
val Loss: 1.4125 Sample-Acc: 0.5977
[2025-04-23 14:13:52] Finished epoch 4
----------
[2025-04-23 14:13:52] Epoch 5/50
train Loss: 1.4015 Sample-Acc: 0.7177
val Loss: 1.4105 Sample-Acc: 0.5976
[2025-04-23 14:15:18] Finished epoch 5
----------
[2025-04-23 14:15:18] Epoch 6/50
train Loss: 1.3990 Sample-Acc: 0.7179
val Loss: 1.4085 Sample-Acc: 0.6012
[2025-04-23 14:16:45] Finished epoch 6
----------
[2025-04-23 14:16:45] Epoch 7/50
train Loss: 1.3991 Sample-Acc: 0.7194
val Loss: 1.4059 Sample-Acc: 0.6010
[2025-04-23 14:18:11] Finished epoch 7
----------
[2025-04-23 14:18:11] Epoch 8/50
train Loss: 1.3934 Sample-Acc: 0.7203
val Loss: 1.4032 Sample-Acc: 0.6041
[2025-04-23 14:19:36] Finished epoch 8
----------
[2025-04-23 14:19:36] Epoch 9/50
train Loss: 1.3941 Sample-Acc: 0.7264
val Loss: 1.4001 Sample-Acc: 0.6135
[2025-04-23 14:21:02] Finished epoch 9
----------
[2025-04-23 14:21:02] Epoch 10/50
train Loss: 1.3929 Sample-Acc: 0.7321
val Loss: 1.3966 Sample-Acc: 0.6251
[2025-04-23 14:22:28] Finished epoch 10
----------
[2025-04-23 14:22:28] Epoch 11/50
train Loss: 1.3895 Sample-Acc: 0.7392
val Loss: 1.3922 Sample-Acc: 0.6220
[2025-04-23 14:23:54] Finished epoch 11
----------
[2025-04-23 14:23:54] Epoch 12/50
train Loss: 1.3814 Sample-Acc: 0.7375
val Loss: 1.3883 Sample-Acc: 0.6220
[2025-04-23 14:25:20] Finished epoch 12
----------
[2025-04-23 14:25:20] Epoch 13/50
train Loss: 1.3793 Sample-Acc: 0.7369
val Loss: 1.3840 Sample-Acc: 0.6213
[2025-04-23 14:26:46] Finished epoch 13
----------
[2025-04-23 14:26:46] Epoch 14/50
train Loss: 1.3781 Sample-Acc: 0.7339
val Loss: 1.3804 Sample-Acc: 0.6170
[2025-04-23 14:28:12] Finished epoch 14
----------
[2025-04-23 14:28:12] Epoch 15/50
train Loss: 1.3796 Sample-Acc: 0.7353
val Loss: 1.3761 Sample-Acc: 0.6141
[2025-04-23 14:29:38] Finished epoch 15
----------
[2025-04-23 14:29:38] Epoch 16/50
train Loss: 1.3667 Sample-Acc: 0.7294
val Loss: 1.3718 Sample-Acc: 0.6144
[2025-04-23 14:31:03] Finished epoch 16
----------
[2025-04-23 14:31:03] Epoch 17/50
train Loss: 1.3737 Sample-Acc: 0.7325
val Loss: 1.3684 Sample-Acc: 0.6168
[2025-04-23 14:32:30] Finished epoch 17
----------
[2025-04-23 14:32:30] Epoch 18/50
train Loss: 1.3637 Sample-Acc: 0.7334
val Loss: 1.3655 Sample-Acc: 0.6134
[2025-04-23 14:33:55] Finished epoch 18
----------
[2025-04-23 14:33:55] Epoch 19/50
train Loss: 1.3605 Sample-Acc: 0.7302
val Loss: 1.3626 Sample-Acc: 0.6109
[2025-04-23 14:35:22] Finished epoch 19
----------
[2025-04-23 14:35:22] Epoch 20/50
train Loss: 1.3610 Sample-Acc: 0.7304
val Loss: 1.3608 Sample-Acc: 0.6078
[2025-04-23 14:36:48] Finished epoch 20
----------
[2025-04-23 14:36:48] Epoch 21/50
train Loss: 1.3636 Sample-Acc: 0.7304
val Loss: 1.3597 Sample-Acc: 0.6040
[2025-04-23 14:38:14] Finished epoch 21
----------
[2025-04-23 14:38:14] Epoch 22/50
train Loss: 1.3453 Sample-Acc: 0.7271
val Loss: 1.3601 Sample-Acc: 0.6007
[2025-04-23 14:39:40] Finished epoch 22
----------
[2025-04-23 14:39:40] Epoch 23/50
train Loss: 1.3595 Sample-Acc: 0.7245
val Loss: 1.3615 Sample-Acc: 0.5974
[2025-04-23 14:41:05] Finished epoch 23
----------
[2025-04-23 14:41:05] Epoch 24/50
train Loss: 1.3623 Sample-Acc: 0.7236
val Loss: 1.3600 Sample-Acc: 0.5970
[2025-04-23 14:42:30] Finished epoch 24
----------
[2025-04-23 14:42:30] Epoch 25/50
train Loss: 1.3635 Sample-Acc: 0.7199
val Loss: 1.3603 Sample-Acc: 0.5973
[2025-04-23 14:43:56] Finished epoch 25
----------
[2025-04-23 14:43:56] Epoch 26/50
train Loss: 1.3661 Sample-Acc: 0.7215
val Loss: 1.3609 Sample-Acc: 0.5963
[2025-04-23 14:45:22] Finished epoch 26
----------
[2025-04-23 14:45:22] Epoch 27/50
train Loss: 1.3597 Sample-Acc: 0.7181
val Loss: 1.3631 Sample-Acc: 0.5951
[2025-04-23 14:46:46] Finished epoch 27
----------
[2025-04-23 14:46:46] Epoch 28/50
train Loss: 1.3690 Sample-Acc: 0.7178
val Loss: 1.3634 Sample-Acc: 0.5967
[2025-04-23 14:48:12] Finished epoch 28
----------
[2025-04-23 14:48:12] Epoch 29/50
train Loss: 1.3693 Sample-Acc: 0.7202
val Loss: 1.3635 Sample-Acc: 0.5963
[2025-04-23 14:49:37] Finished epoch 29
----------
[2025-04-23 14:49:37] Epoch 30/50
train Loss: 1.3753 Sample-Acc: 0.7165
val Loss: 1.3670 Sample-Acc: 0.5931
[2025-04-23 14:51:03] Finished epoch 30
----------
[2025-04-23 14:51:03] Epoch 31/50
train Loss: 1.3726 Sample-Acc: 0.7159
val Loss: 1.3680 Sample-Acc: 0.5913
[2025-04-23 14:52:29] Finished epoch 31
----------
[2025-04-23 14:52:29] Epoch 32/50
train Loss: 1.3732 Sample-Acc: 0.7137
val Loss: 1.3713 Sample-Acc: 0.5920
[2025-04-23 14:53:54] Finished epoch 32
----------
[2025-04-23 14:53:54] Epoch 33/50
train Loss: 1.3761 Sample-Acc: 0.7178
val Loss: 1.3719 Sample-Acc: 0.5920
[2025-04-23 14:55:20] Finished epoch 33
----------
[2025-04-23 14:55:20] Epoch 34/50
train Loss: 1.3879 Sample-Acc: 0.7166
val Loss: 1.3754 Sample-Acc: 0.5918
[2025-04-23 14:56:46] Finished epoch 34
----------
[2025-04-23 14:56:46] Epoch 35/50
train Loss: 1.3761 Sample-Acc: 0.7188
val Loss: 1.3799 Sample-Acc: 0.5927
[2025-04-23 14:58:11] Finished epoch 35
----------
[2025-04-23 14:58:11] Epoch 36/50
train Loss: 1.3662 Sample-Acc: 0.7176
val Loss: 1.3856 Sample-Acc: 0.5943
[2025-04-23 14:59:37] Finished epoch 36
----------
[2025-04-23 14:59:37] Epoch 37/50
train Loss: 1.3777 Sample-Acc: 0.7205
val Loss: 1.3908 Sample-Acc: 0.5939
[2025-04-23 15:01:03] Finished epoch 37
----------
[2025-04-23 15:01:03] Epoch 38/50
train Loss: 1.4043 Sample-Acc: 0.7164
val Loss: 1.3892 Sample-Acc: 0.5939
[2025-04-23 15:02:29] Finished epoch 38
----------
[2025-04-23 15:02:29] Epoch 39/50
train Loss: 1.3751 Sample-Acc: 0.7163
val Loss: 1.3899 Sample-Acc: 0.5955
[2025-04-23 15:03:55] Finished epoch 39
----------
[2025-04-23 15:03:55] Epoch 40/50
train Loss: 1.3923 Sample-Acc: 0.7200
val Loss: 1.3953 Sample-Acc: 0.5942
[2025-04-23 15:05:20] Finished epoch 40
----------
[2025-04-23 15:05:20] Epoch 41/50
train Loss: 1.4004 Sample-Acc: 0.7190
val Loss: 1.3959 Sample-Acc: 0.5955
[2025-04-23 15:06:45] Finished epoch 41
----------
[2025-04-23 15:06:45] Epoch 42/50
train Loss: 1.3947 Sample-Acc: 0.7194
val Loss: 1.3991 Sample-Acc: 0.5962
[2025-04-23 15:08:11] Finished epoch 42
----------
[2025-04-23 15:08:11] Epoch 43/50
train Loss: 1.3946 Sample-Acc: 0.7182
val Loss: 1.4020 Sample-Acc: 0.5972
[2025-04-23 15:09:37] Finished epoch 43
----------
[2025-04-23 15:09:37] Epoch 44/50
train Loss: 1.4198 Sample-Acc: 0.7211
val Loss: 1.4024 Sample-Acc: 0.5983
[2025-04-23 15:11:02] Finished epoch 44
----------
[2025-04-23 15:11:02] Epoch 45/50
train Loss: 1.4119 Sample-Acc: 0.7212
val Loss: 1.4100 Sample-Acc: 0.5985
[2025-04-23 15:12:28] Finished epoch 45
----------
[2025-04-23 15:12:28] Epoch 46/50
train Loss: 1.3964 Sample-Acc: 0.7203
val Loss: 1.4195 Sample-Acc: 0.5996
[2025-04-23 15:13:54] Finished epoch 46
----------
[2025-04-23 15:13:54] Epoch 47/50
train Loss: 1.4166 Sample-Acc: 0.7218
val Loss: 1.4246 Sample-Acc: 0.6012
[2025-04-23 15:15:20] Finished epoch 47
----------
[2025-04-23 15:15:20] Epoch 48/50
train Loss: 1.4229 Sample-Acc: 0.7210
val Loss: 1.4271 Sample-Acc: 0.6013
[2025-04-23 15:16:46] Finished epoch 48
----------
[2025-04-23 15:16:46] Epoch 49/50
train Loss: 1.4167 Sample-Acc: 0.7202
val Loss: 1.4321 Sample-Acc: 0.6010
[2025-04-23 15:18:11] Finished epoch 49
----------
[2025-04-23 15:18:11] Epoch 50/50
train Loss: 1.4293 Sample-Acc: 0.7179
val Loss: 1.4364 Sample-Acc: 0.5993
[2025-04-23 15:19:38] Finished epoch 50
----------
Training complete. Best val loss: 1.3597
Test Sample-Acc: 0.5889
Traceback (most recent call last):
  File "/gpfs/u/scratch/TRSL/shared/code2/main.py", line 89, in <module>
    main()
  File "/gpfs/u/scratch/TRSL/shared/code2/main.py", line 67, in main
    trainer.save('gan_generator.pth', 'gan_discriminator.pth')
TypeError: CNNTrainer.save() takes 2 positional arguments but 3 were given
srun: error: npl29: task 0: Exited with exit code 1
[15:20:54] SLURM job complete
